# 准备

## 解压版MySql安装

下载地址：https://downloads.mysql.com/archives/community/

### 1.安装、配置

1. 解压到安装的目录

2. 在解压缩的根目录下新建 `my.ini` 文件，然后再其中写入配置信息，并保持

   ```js
   [mysqld]
   #设置时区为东八区，此项设置后，在连接MySQL的时候可以不用每次都手动设置时区
   default-time-zone = '+8:00'
   # 设置3306端口
   port=3306
   # 允许最大连接数
   max_connections=200
   # 允许连接失败的次数。这是为了防止有人从该主机试图攻击数据库系统
   max_connect_errors=10
   # 服务端使用的字符集默认为UTF8
   character-set-server=utf8
   # 创建新表时将使用的默认存储引擎
   default-storage-engine=INNODB
   # 默认使用mysql_native_password caching_sha2_password”插件认证
   default_authentication_plugin=mysql_native_password
   # 解决导入脚本时funtion报错
   log_bin_trust_function_creators=1
   [mysql]
   # 设置mysql客户端默认字符集
   default-character-set=utf8
   [client]
   # 设置mysql客户端连接服务端时默认使用的端口
   port=3306
   user=root
   password=
   default-character-set=utf8
   ```

3. 配置环境变量，将`bin`目录的路径加到系统变量的`path`结尾

   > I:\Program\mysql-8.0.33\bin

4. (win + R)用管理员方式打开`命令行`，进入`MYSQL`的`bin`目录下（cd/d bin）路径，输入`mysqld -l --console`，运行完成后会在根目录下生成`data`文件夹，密码生成在`cmd`控制台，复制保存下来

5. 安装`MYSQL`服务，命令行输入`mysqld --install m8`

6. 启动服务，命令行输入`net start mysql8.0`，或者打开服务器找到 `mysql8.0/m8`，点击然后选择启动

### 2.测试

1. 控制台输入`mysql -u -root -p`，输入密码，登录MYSQL登录成功
2. 修改密码，在控制台输入`set password='123456'`之后就可以用`root`登录了

## 参数说明

在命令行链接 mysql 的参数

| 选项 | 说明            | 默认           |
| ---- | --------------- | -------------- |
| -u   | 账号            | 当前系统名账号 |
| -p   | 密码            |                |
| -P   | 链接端口        | 3306           |
| -h   | 主机地址        | 127.0.0.1      |
| -e   | 执行 sql 的指令 |                |

### 链接服务器

```js
musql -uroot -p -P3306 -h127.0.0.1
```

<b>链接本地数据库时可以使用默认</b>

```js
mysql -uroot -p
```

<b>使用`-e`执行SQL语句</b>

```js
mysql -uroot -proot -e 'show databases';
```

<b>退出</b>

<b>命令行执行 `exit`可以退出当前链接</b>

```js
exit
```

<b>执行与取消</b>

每条SQL指令以`;`结束，按回车键后执行该条语句

```js
show databases;
```

<b>放弃语句</b>

在SQL 后使用 `\c`表示取消本条 SQL，后面不需要写`;`。

## 数据库管理

### 常用指令

#### 数据库列表

使用一下面命令可以得到当前服务中的所有数据库

```js
show databases;
```

#### 创建数据库

下面是创建数据库`text`并设置字符为`utf8`

```js
CREATE DATABASES test CHARSET utf8;
```

#### 查看数据库

```js
show create databaases test;
```

#### 删除数据库

```js
drop databases test;
```

#### 为了防止删除不存在的数据报错

```js
drop databases if exists test;
```

#### 选择数据库

数据库主要是对表操作，选择数据库后可以省略掉每次指定数据库的麻烦

```js
use test;
```

### 导入语句

有时需要把外部的`SQL`文件导入到服务器中，图像化的数据库管理软件都支持导入

#### 创建文件

创建`test.sql`文件内容下

```js
create databases test chartset utf8;
SHOW databases;
```

#### 外部导入

```sql
mysql -yroot -p <test.sql
```

#### 连接后导入

```sql
mysql -uroot -p
>source test.sql
```

## 数据表管理

可以把数据库理解为文件夹，数据表理解为文件，数据表时真正存储数据的地方

### 基本操作

### 创建数据表

```sql
create table class(
 	id int primary key AUTO_INCREMENT,
    cname varchar(30) NOT NULL,
    description varchar(100) default NULL)
    charset utf8
```

以上语句创建表`class`字段说明如下：

- 字段`id`为主键自增
- 字段`cname`为字符串类型，`varchar`并不允许为 null
- 字段`description`为可为`null`字符串
- 字符集`utf8`，如果不设置将继承数据库字符集

### 添加测试数据 

```sql
INSERT INTO class (cname,description) VALUE('PHP','测试数据PHP');
INSERT INTO class (cname) VALUES('MySql');
```

因为`description` 设置为 `null` 所以第二个记录没有设置值时，使用默认的`null`值

### 复制数据

<b>根据已经存在的表结构创建新表</b>

```sql
create table users like class;
```

<b>复制其他表的数据</b>

```sql
insert into users select * from class;
```

<b>只复制批定字段</b>

```sql
insert into users (cname) select cname from class;
```

<b>复制表时同时复制数据</b>

```sql
create table users select * from class;
```

<b>下面是只复制指定字段，并为不同名字段起别名</b>

```sql
create table users (id int primary key AUTO_INCREMENT,name varchar(30)) select id,cname as name from class;
```

<b>删除数据表</b>

```sql
DROP TEMPORARY TABLE IF EXISTS user;
```

### 临时表

临时表是用于储存临时数据表，会在数据库中断时自动删除

- 可以与普通表同名，优先级高于普通表
- 连接终端时自动删除

```sql
create TEMPORARY TABLE class_name SELECT * FROM class;
select * from class_name;
```

<b>删除临时表</b>

```sql
DROP TEMPORARY TABLE IF EXISTS class_names;
```

## 查询数据

### 测试表

为了进行查询示例操作我们创建一下表

```sql
CREATE TABLE stu (id int PRIMARY KEY AUTO_INCREMENT,SNAME char(30),class_id 
 int default null,age smallint default null)
 
 INSERT INTO stu(sname,class_id,age) VALUES('小明'，1，20),('张三',2,32),('李四',3,null)
```

### 字段处理

查询所有字段数据

```sql
select * from class;
```

查询指定字段数据并排序字段

```sql
select description,cname from class
```

### 条件筛选

根据条件查询

